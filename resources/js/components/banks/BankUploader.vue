<template>
    <vue-dropzone ref="myVueDropzone" @vdropzone-success="onSuccess" :useCustomSlot=true
                  class="mt-16 rounded-lg border-gray-800 flex flex-col items-center justify-center" id="dropzone"
                  :options="dropzoneOptions">
        <div class="dz-default dz-message">
            <span class="inline-flex">Выберите
                <svg class="w-6 h-6 mx-1" viewBox="0 0 512 512">
                    <path d="M121.784 157.161v121.045H26.695v-87.125c0-18.73 15.19-33.92 33.92-33.92h17.34z"
                          fill="#bed8fb"/><path
                    d="M485.305 198.27v266.35c0 22.03-17.85 39.88-39.87 39.88h-327.6c-18.82 0-34.59-13.04-38.78-30.58l-.16-22.8-.93-135.78V47.38c0-22.03 17.85-39.88 39.87-39.88h176.7c15.88 0 67.31 43.85 112.77 90.03 41.48 42.15 78 86.24 78 100.74z"
                    fill="#ddeafb"/><path
                    d="M485.305 198.27v97.57c0-.11-.01-.22-.01-.34-3-119.72-100.52-125.26-132.41-157.15l54.42-40.82c41.48 42.15 78 86.24 78 100.74z"
                    fill="#cbe2ff"/><path
                    d="M294.53 7.5h-97.57c.11 0 .22.01.34.01 119.72 3 125.26 100.52 157.15 132.41l40.82-54.42c-42.15-41.48-86.24-78-100.74-78z"
                    fill="#cbe2ff"/><path
                    d="M485.304 198.276v16.868c0-35.514-28.798-64.312-64.312-64.312h-39.143c-22.019 0-39.877-17.858-39.877-39.877V71.812c0-35.514-28.798-64.312-64.312-64.312h16.868a114.547 114.547 0 0180.989 33.545l76.242 76.242a114.544 114.544 0 0133.545 80.989z"
                    fill="#bed8fb"/><path
                    d="M347.931 309.3v89.44c0 28.93-23.45 52.38-52.38 52.38H78.891l-.93-135.78v-58.42h217.59c28.93 0 52.38 23.45 52.38 52.38z"
                    fill="#cbe2ff"/><path
                    d="M381.851 277.38v89.44c0 28.93-23.45 52.38-52.38 52.38H60.621c-1.01 0-2-.04-2.99-.14-17.33-1.5-30.93-16.05-30.93-33.78v-194.2c0 9.36 3.8 17.84 9.94 23.98 5.47 5.48 12.81 9.1 20.99 9.8.99.1 1.98.14 2.99.14h268.85c28.93 0 52.38 23.45 52.38 52.38z"
                    fill="#78d0b1"/><path
                    d="M57.631 224.86v194.2c-17.33-1.5-30.93-16.05-30.93-33.78v-194.2c0 9.36 3.8 17.84 9.94 23.98 5.47 5.48 12.81 9.1 20.99 9.8z"
                    fill="#61aab7"/><g><path
                    d="M492.804 198.28c0-32.607-12.695-63.253-35.746-86.293l-64.37-64.38c-2.93-2.928-7.679-2.93-10.606-.001a7.5 7.5 0 00-.001 10.607l64.372 64.382c12.184 12.178 21.069 26.779 26.206 42.719-13.068-13.546-31.399-21.984-51.664-21.984h-39.15c-17.849 0-32.37-14.526-32.37-32.38V71.81c0-20.19-8.375-38.46-21.834-51.52 10.989 3.578 21.404 8.911 30.701 15.819a7.5 7.5 0 008.947-12.039C346.403 8.55 320.565.002 294.533 0H117.83C91.71 0 70.46 21.255 70.46 47.38v102.281h-9.845c-22.839 0-41.419 18.581-41.419 41.419v194.204c0 22.839 18.581 41.419 41.419 41.419h10.606l.328 47.269c.004.57.073 1.137.205 1.691C76.866 497.058 95.813 512 117.83 512h327.6c26.12 0 47.37-21.255 47.37-47.38zM60.615 164.661h9.845v52.838h-9.845c-14.568 0-26.419-11.852-26.419-26.419s11.851-26.419 26.419-26.419zM445.429 497h-327.6c-14.775 0-27.525-9.841-31.287-24.034l-.321-46.263h243.247c33.018 0 59.88-26.862 59.88-59.88V277.38c0-33.018-26.862-59.88-59.88-59.88H159.119a7.5 7.5 0 000 15H329.47c24.747 0 44.88 20.133 44.88 44.88v89.443c0 24.747-20.133 44.88-44.88 44.88H60.615c-14.568 0-26.419-11.852-26.419-26.419V222.953c7.176 5.958 16.386 9.546 26.419 9.546h68.504a7.5 7.5 0 000-15H85.46V47.38C85.46 29.526 99.981 15 117.83 15h159.835c31.325 0 56.81 25.485 56.81 56.81v39.14c0 26.125 21.25 47.38 47.37 47.38h39.15c31.261 0 56.7 25.381 56.805 56.617V464.62c0 17.854-14.522 32.38-32.371 32.38z"/><path
                    d="M197.509 376.99c.536.092 1.121.192 11.451.192 5.049 0 12.427-.024 23.265-.084 4.142-.023 7.481-3.4 7.458-7.542s-3.379-7.511-7.542-7.458c-7.705.043-18.725.084-25.866.08v-87.904a7.5 7.5 0 00-15 0v95.324a7.5 7.5 0 006.234 7.392zM294.658 377.178c17.669 0 33.056-11.547 35.789-26.859 3.143-17.598-10.808-29.427-24.909-34.628-12.448-4.591-23.981-9.608-26.695-10.802-3.416-2.451-5.08-6.405-4.466-10.683.755-5.256 4.752-9.463 10.692-11.253 15.859-4.775 30.085 6.679 30.342 6.889a7.5 7.5 0 009.628-11.502c-.826-.694-20.498-16.919-44.296-9.749-11.503 3.465-19.632 12.464-21.214 23.483-1.469 10.233 2.961 20.074 11.563 25.682.331.216.679.406 1.04.567.547.244 13.555 6.034 28.215 11.442 11.051 4.076 16.64 10.607 15.334 17.918-1.255 7.027-9.049 14.495-21.022 14.495-10.711 0-21.062-4.366-27.688-11.678a7.501 7.501 0 00-11.115 10.073c9.422 10.397 23.928 16.605 38.802 16.605zM101.696 269.958a7.5 7.5 0 10-12.269 8.63l28.136 39.996-32.951 46.774a7.501 7.501 0 0012.263 8.639l29.856-42.381 29.811 42.377a7.49 7.49 0 006.141 3.186 7.5 7.5 0 006.128-11.815l-32.903-46.772 28.177-39.998a7.501 7.501 0 00-12.263-8.639l-25.082 35.604z"/></g>
                        </svg>
                файл для импорта</span>
        </div>
    </vue-dropzone>
</template>

<script>
import vue2Dropzone from 'vue2-dropzone'
import 'vue2-dropzone/dist/vue2Dropzone.min.css'

export default {
    name: "BankUploader",
    components: {
        vueDropzone: vue2Dropzone
    },
    props: {
        token: {
            required: true
        }
    },
    data: function () {
        return {
            dropzoneOptions: {
                url: '/api/banks/upload',
                maxFiles: 5,
                acceptedFiles: '.xls,.xlsx',
                thumbnailWidth: 120,
                headers: {'Authorization': 'Bearer ' + this.token}
            }
        }
    },
    methods: {
        onSuccess(file, response) {
            this.$notify({
                title: 'Файл загружен',
                text: 'Список банков успешно обновлен',
                type: 'success'
            })
            this.$root.$emit('uploadBanks')
        }
    }
}
</script>

<style lang="scss">
.dropzone {
    background-color: transparent !important;
    border-style: dashed;

    &:hover {
        @apply border-gray-800 text-gray-800;
    }

    .dz-preview{
        display: none !important;
    }

    &.dz-started {
        .dz-message{
            display: block !important;
        }
    }
}
</style>

